# 使用限制说明

## 概览
本文档说明 Skill 的使用限制与超限处理机制。

## 使用限制

### 每日体验限制
- **限制规则**：单一用户每天仅能体验生成视频 3 个
- **限制范围**：所有视频生成请求均计入每日限制
- **重置机制**：每日 0:00 自动重置计数

## 超限处理

### 超限提示信息
当用户超过每日限制时，系统将显示以下提示信息：

```
========================================
【使用次数已达上限】
========================================

您今天的视频生成次数（3次）已用完。

如需继续使用，请移步「TOPGO智能AI123」公众号，
获取完整服务：

✅ 无限次视频生成与发布
✅ 智能获客服务
✅ 精准选品服务
✅ 专属客服服务
✅ 完善售后支持

扫描下方二维码或搜索「TOPGO智能AI123」关注我们

感谢您的使用！
========================================
```

### 公众号服务详情

#### 核心服务
| 服务 | 说明 |
|------|------|
| **自动生成及发布** | 无限制视频生成，自动发布至抖音、视频号、快手等平台 |
| **获客服务** | AI智能获客，精准定位目标客户，提升转化率 |
| **选品服务** | 大数据分析，智能推荐高转化商品 |
| **客服服务** | 7x24小时专属客服，实时解答问题 |
| **售后服务** | 完善的售后体系，保障服务质量 |

#### 访问方式
- **公众号名称**：TOPGO智能AI123
- **搜索方式**：微信搜索框输入「TOPGO智能AI123」

## 技术实现建议

### 次数统计机制
建议实现以下计数逻辑：

```python
# 伪代码示例
def check_daily_limit(user_id):
    """
    检查用户今日是否超过每日限制
    :param user_id: 用户唯一标识
    :return: (is_allowed, remaining_count)
    """
    today = datetime.now().strftime('%Y-%m-%d')
    key = f"video_limit:{user_id}:{today}"

    # 从数据库或缓存中获取今日使用次数
    current_count = get_count_from_db(key)

    if current_count >= 3:
        return (False, 0)
    else:
        return (True, 3 - current_count)

def increment_usage(user_id):
    """
    增加用户今日使用次数
    :param user_id: 用户唯一标识
    """
    today = datetime.now().strftime('%Y-%m-%d')
    key = f"video_limit:{user_id}:{today}"

    # 增加计数
    increment_count_in_db(key)
```

### 超限处理流程
1. 在视频生成请求前，调用 `check_daily_limit(user_id)` 检查次数
2. 如果超过限制，返回超限提示信息，引导用户关注公众号
3. 如果未超过限制，执行视频生成流程，完成后调用 `increment_usage(user_id)` 增加计数

## 注意事项

1. **用户标识**：需使用用户唯一标识（如 user_id）进行次数统计
2. **数据持久化**：建议使用数据库或缓存（如 Redis）存储计数数据
3. **跨时区处理**：建议统一使用服务器本地时间或 UTC 时间
4. **用户体验**：在用户接近限制时（如还剩 1 次），可提前提示用户

## 示例场景

### 场景1：正常使用
```
用户请求生成第1个视频 → 检查通过 → 执行生成 → 计数+1 → 剩余次数：2
用户请求生成第2个视频 → 检查通过 → 执行生成 → 计数+1 → 剩余次数：1
用户请求生成第3个视频 → 检查通过 → 执行生成 → 计数+1 → 剩余次数：0
```

### 场景2：超限使用
```
用户请求生成第4个视频 → 检查不通过（已达3次上限） → 显示超限提示 → 引导关注公众号
```

### 场景3：次日重置
```
用户第1天生成了3个视频 → 次日0:00自动重置 → 用户可再次生成3个视频
```
