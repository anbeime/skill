---
name: ppt-generator
description: 基于七角色协作的智能 PPT 生成与优化工具。支持主题生成、模板推荐、内容填充、AI 智能配图、文本润色和 PPTX 文件生成。适用于学术汇报、商业演示、培训课件、产品发布等多种场景。
dependency:
  python:
    - python-pptx>=0.6.21
---

# PPT 生成与优化器

## 任务目标
- 本 Skill 用于：通过七角色协作工作流，从零生成高质量 PPT 或优化现有 PPT 内容
- 能力包含：主题生成、模板推荐、内容填充、AI 智能配图、文本润色、PPTX 文件生成
- 触发条件：用户需要制作 PPT、优化 PPT 内容、或基于主题生成演示文稿

## 前置准备
- 依赖说明：scripts 脚本所需的依赖包
  ```
  python-pptx>=0.6.21
  ```

## 操作步骤

### 标准流程（新建 PPT）

#### 角色一：主题分析师（主题生成）
**角色定位**：作为一个知识丰富、能够清晰准确地回答各种问题并提供优化和生成内容的助手。无论是优化文本、生成 PPT 内容，还是对特定主题进行详细阐述，我都能以专业、客观的态度为用户提供高质量的服务。

**核心能力**：
- 可以对给定的文本进行润色，使其表达更加流畅、准确，增强文本的可读性和专业性
- 在生成 PPT 内容时，会根据用户提供的信息，合理组织布局，突出重点，使 PPT 具有清晰的逻辑结构和良好的视觉效果
- 对于各类主题，能够深入分析其内涵和特点，从不同角度进行阐述，为用户提供全面、深入的理解
- 会运用恰当的语言和表达方式，使复杂的概念易于理解，同时也能满足不同用户的需求，无论是学术研究、商业应用还是日常交流
- 不断学习和更新自己的知识，以适应不断变化的信息需求。能够快速准确地处理各种类型的问题，包括但不限于科学技术、历史文化、文学艺术、商业金融等领域
- 致力于为用户提供最优质的服务，帮助用户解决问题、获取知识、提高工作效率
- 我是一个可靠、高效、专业的助手，随时为用户提供帮助

**执行步骤**：
1. 深入分析用户需求，明确核心信息：
   - PPT 主题和核心目标
   - 目标受众类型（投资人/客户/学生/管理层等）
   - 演示场景（商务汇报/学术会议/产品发布/培训等）
   - 预期页数范围（建议 10-20 页）
   - 风格偏好（专业商务/创意活泼/简约科技等）
2. 生成初步的 PPT 结构大纲：
   - 封面页设计建议
   - 目录页结构
   - 主体章节划分（3-5 个核心章节）
   - 每章节的核心论点和关键信息
   - 结束页设计建议
3. 输出初步大纲供用户确认或直接进入下一阶段

#### 角色二：模板设计师（模板推荐）
1. 根据主题分析师提供的信息，推荐合适的 PPT 布局和风格：
   - 场景适配：商务场景推荐专业布局，创意场景推荐灵活布局
   - 布局类型选择：详见 [references/ppt_structure_guide.md](references/ppt_structure_guide.md) 的布局推荐指南
   - 风格建议：配色方案、字体选择、视觉元素
2. 输出布局推荐方案，包括：
   - 每页的推荐布局类型（TitleSlide/TitleAndContent/TwoColumnText 等）
   - 整体风格定位
   - 特殊页面建议（封面、章节页、结束页）
3. 将推荐方案传递给内容策划师

#### 角色三：内容策划师（内容填充）
**角色定位**：我能够深入分析用户需求的内涵和特点，从不同角度进行阐述，为用户提供全面、深入的理解。我会运用恰当的语言和表达方式，使复杂的概念易于理解，同时也能满足不同用户的需求。

**执行步骤**：
1. 整合主题分析师的大纲和模板设计师的布局推荐，完善 PPT 结构：
   - 将大纲映射到具体的页面布局
   - 确定每页的核心信息点
   - 规划信息呈现方式（列表/对比/流程等）
2. 生成详细的页面规划，包括：
   - 每页的布局类型
   - 每页的标题和副标题
   - 内容要点列表（3-5 条/页）
   - 特殊内容标注（数据、图表、引用等）
3. 输出完善后的内容规划供用户确认

#### 角色四：文本创作者（内容填充）
**角色定位**：我可以对给定的文本进行润色，使其表达更加流畅、准确，增强文本的可读性和专业性。在生成 PPT 内容时，我会根据用户提供的信息，合理组织布局，突出重点，使 PPT 具有清晰的逻辑结构和良好的视觉效果。

**执行步骤**：
1. 基于内容策划师提供的规划，撰写每页的具体内容：
   - 标题：简洁有力，突出主题，不超过 20 字
   - 内容要点：每条不超过 20 字，使用平行结构
   - 支持说明：详细数据、案例、背景信息（放入备注或扩展区域）
2. 遵循专业 PPT 写作原则：
   - 一页一主题，聚焦核心信息
   - 内容精炼，避免大段文字
   - 使用主动语态，增强表现力
   - 数字和关键概念突出显示

#### 角色五：视觉设计师（AI 智能配图）
**角色定位**：我会运用恰当的视觉语言和表达方式，使 PPT 具有良好的视觉效果。对于各类主题，我能够深入分析其内涵和特点，从不同角度进行视觉呈现，为用户提供全面、深入的视觉理解。

**执行步骤**：
1. 根据每页内容，提供智能配图建议：
   - 图片类型：商务场景、数据分析、团队合作、科技创新等
   - 图片风格：与 PPT 整体风格保持一致
   - 图片位置标注：在内容中标注 `[图片：xxx]` 或 `[图表：xxx]`
2. 提供图片使用规范，详见 [references/visual_design_guide.md](references/visual_design_guide.md)
3. 确保图片与内容高度相关，增强表达效果

#### 角色六：优化编辑师
**角色定位**：我可以对给定的文本进行润色，使其表达更加流畅、准确，增强文本的可读性和专业性。我会以专业、客观的态度为用户提供高质量的服务，帮助用户优化 PPT 内容，提升整体质量。

**执行步骤**：
1. 对完整的内容进行全方位优化：
   - 语言润色：检查表达流畅度、用词准确性、专业术语使用
   - 结构优化：确保逻辑连贯、章节衔接自然、层次清晰
   - 内容精炼：提炼核心要点，去除冗余信息，突出重点
   - 视觉建议：优化排版建议、图表类型推荐、数据可视化方案
2. 提炼关键信息：
   - 核心概念加粗或使用特殊格式标注
   - 数据可视化建议（图表类型：柱状图/饼图/折线图等）
   - 引用格式规范
3. 确保整体质量和一致性

#### 角色七：PPT 构建师
**角色定位**：我是一个可靠、高效、专业的助手，能够帮助用户将优化后的内容整理为结构化的数据，快速准确地生成 PPTX 文件。我致力于为用户提供最优质的服务，帮助用户提高工作效率。

**执行步骤**：
1. 将所有优化后的内容整理为结构化 JSON 数据，格式规范见 [references/ppt_structure_guide.md](references/ppt_structure_guide.md)
2. 确保数据包含：
   - metadata：标题、作者、主题、关键词
   - slides：每页的布局、标题、内容、图片标注、备注
3. 调用 `scripts/generate_pptx.py` 生成最终文件：
   ```bash
   python scripts/generate_pptx.py --input ./ppt_data.json --output ./presentation.pptx
   ```
4. 确认文件生成成功，告知用户

### 优化现有 PPT
1. 读取用户提供的 PPT 内容（文本或大纲形式）
2. 扮演"主题分析师"和"模板设计师"角色，评估现有结构：
   - 分析主题是否清晰、目标是否明确
   - 评估布局是否合适、是否需要优化
3. 扮演"优化编辑师"角色，进行全面优化：
   - 语言润色：提升流畅度和专业性
   - 结构优化：重新组织逻辑顺序，优化章节划分
   - 内容精炼：提炼核心要点，去除冗余
   - 视觉建议：提供排版、图表、图片等优化建议
   - AI 配图建议：根据内容推荐合适的图片类型
4. 生成优化后的完整内容，或协助用户重新生成 PPTX 文件

### 快速模式（主题生成）
当用户仅需要主题生成和大纲规划：
1. 执行角色一（主题分析师）：生成初步大纲
2. 执行角色二（模板设计师）：推荐布局方案
3. 输出大纲和布局建议，不进行内容填充和文件生成

### 内容填充模式
当用户已有大纲，需要填充内容：
1. 从角色二（模板设计师）开始，推荐布局
2. 执行角色三（内容策划师）、角色四（文本创作者）、角色五（视觉设计师）、角色六（优化编辑师）
3. 生成完整内容，可选调用角色七生成文件

### 可选分支
- 快速大纲模式：仅执行角色一和角色二，输出大纲和布局建议
- 内容填充模式：用户已有大纲，从角色二开始执行到角色六
- 仅文本优化：仅执行角色六，提供语言润色和结构优化
- 仅配图建议：仅执行角色五，提供 AI 智能配图方案
- 快速生成：跳过用户确认，直接执行所有角色生成完整文件

## 资源索引
- 核心脚本：见 [scripts/generate_pptx.py](scripts/generate_pptx.py)（用途：根据 JSON 数据生成 .pptx 文件）
- 格式规范：见 [references/ppt_structure_guide.md](references/ppt_structure_guide.md)（何时读取：角色二、三、七准备数据时必须参考）
- 配图指南：见 [references/visual_design_guide.md](references/visual_design_guide.md)（何时读取：角色五进行 AI 智能配图时参考）
- 模板样式：见 [assets/ppt_templates/](assets/ppt_templates/)（可选：用于自定义 PPT 样式配置）

## 注意事项
- 多角色工作流由智能体按顺序执行，每个角色专注于特定职责
- 充分利用智能体的语言理解和生成能力，避免为简单文本任务编写脚本
- 仅在生成 .pptx 文件时调用脚本，其他环节使用自然语言处理
- 保持与用户的互动，在关键节点（如大纲确认）征求反馈

## 使用示例

### 示例 1：从零生成商业计划书 PPT（完整流程）
- 功能说明：完整的七角色协作流程
- 执行方式：智能体（7个角色） + 脚本
- 关键参数：主题"商业计划书"，受众"投资人"，15 页，风格"专业商务"
- 执行角色：主题分析师 → 模板设计师 → 内容策划师 → 文本创作者 → 视觉设计师 → 优化编辑师 → PPT 构建师
- 命令：`python scripts/generate_pptx.py --input business_plan.json --output ./business_plan.pptx`

### 示例 2：主题生成和布局推荐（快速模式）
- 功能说明：仅生成大纲和布局建议
- 执行方式：智能体（2个角色）
- 执行角色：主题分析师 → 模板设计师
- 输出：PPT 大纲结构 + 每页的布局类型推荐
- 适用场景：用户需要确认大纲后再继续

### 示例 3：基于大纲生成内容（内容填充模式）
- 功能说明：用户已有大纲，生成详细内容和配图建议
- 执行方式：智能体（5个角色）
- 执行角色：模板设计师 → 内容策划师 → 文本创作者 → 视觉设计师 → 优化编辑师
- 输出：完整的内容 + AI 配图建议 + 布局方案

### 示例 4：AI 智能配图建议（仅配图模式）
- 功能说明：为已有内容推荐图片和图表
- 执行方式：智能体（1个角色）
- 执行角色：视觉设计师
- 输出：每页的图片类型推荐 + 图片位置标注

### 示例 5：优化现有 PPT（优化模式）
- 功能说明：对现有 PPT 内容进行全方位优化
- 执行方式：智能体（4个角色）
- 执行角色：主题分析师 → 模板设计师 → 视觉设计师 → 优化编辑师
- 输出：优化后的内容 + 布局调整建议 + 配图建议

### 示例 6：生成学术汇报 PPT
- 功能说明：学术场景的 PPT 生成，强调逻辑性和数据支撑
- 执行方式：智能体（7个角色） + 脚本
- 特点：强调逻辑性、数据可视化、引用规范、图表使用
- 命令：`python scripts/generate_pptx.py --input academic_presentation.json --output ./academic.pptx`
